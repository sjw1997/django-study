class AcGameMenu{constructor(t){this.root=t,this.$menu=$('\n<div class="ac-game-menu">\n    <div class="ac-game-menu-field">\n        <div class="ac-game-menu-field-item ac-game-menu-field-item-single-mode">单人模式</div>\n        <br>\n        <div class="ac-game-menu-field-item ac-game-menu-field-item-multi-mode">多人模式</div>\n        <br>\n        <div class="ac-game-menu-field-item ac-game-menu-field-item-settings">退出</div>\n    </div>\n</div>'),this.$menu.hide(),this.root.$ac_game.append(this.$menu),this.$single_mode=this.$menu.find(".ac-game-menu-field-item-single-mode"),this.$multi_mode=this.$menu.find(".ac-game-menu-field-item-multi-mode"),this.$settings=this.$menu.find(".ac-game-menu-field-item-settings"),this.start()}start(){this.add_listening_events()}add_listening_events(){let t=this;this.$single_mode.click((function(){t.hide(),t.root.playground.show("single mode")})),this.$multi_mode.click((function(){t.hide(),t.root.playground.show("multi mode")})),this.$settings.click((function(){console.log("click settings"),t.root.settings.logout_on_remote()}))}show(){this.$menu.show()}hide(){this.$menu.hide()}}let last_timestamp,AC_GAME_OBJECTS=[];class AcGameObject{constructor(){AC_GAME_OBJECTS.push(this),this.has_called_start=!1,this.timedelta=0,this.uuid=this.create_uuid()}create_uuid(){let t="";for(let s=0;s<8;s++){t+=parseInt(Math.floor(10*Math.random()))}return t}start(){}update(){}late_update(){}on_destroy(){}destroy(){this.on_destroy();for(const t in AC_GAME_OBJECTS)if(AC_GAME_OBJECTS[t]===this){AC_GAME_OBJECTS.splice(t,1);break}}}let AC_GAME_ANIMATION=function(t){for(const s of AC_GAME_OBJECTS)s.has_called_start?(s.timedelta=t-last_timestamp,s.update()):(s.start(),s.has_called_start=!0);for(const t of AC_GAME_OBJECTS)t.late_update();last_timestamp=t,requestAnimationFrame(AC_GAME_ANIMATION)};requestAnimationFrame(AC_GAME_ANIMATION);class ChatField{constructor(t){this.playground=t,this.$history=$('<div class="ac-game-chat-field-history">历史记录</div>'),this.$input=$('<input type="text" class="ac-game-chat-field-input">'),this.$history.hide(),this.$input.hide(),this.func_id=null,this.playground.$playground.append(this.$history),this.playground.$playground.append(this.$input),this.start()}start(){this.add_listening_events()}add_listening_events(){this.$input.keydown((t=>{if(27===t.which)return this.hide_input(),!1;if(13===t.which){const t=this.playground.root.settings.username,s=this.$input.val();return s&&(this.$input.val(""),this.add_message(t,s),this.playground.mps.send_message(t,s)),!1}}))}render_message(t){return $(`<div>${t}</div>`)}add_message(t,s){const i=`[${t}]${s}`;this.$history.append(this.render_message(i)),this.$history.scrollTop(this.$history[0].scrollHeight),this.show_history()}show_history(){this.$history.fadeIn(),this.func_id&&clearTimeout(this.func_id),this.func_id=setTimeout((()=>{this.$history.fadeOut(),this.func_id=null}),3e3)}show_input(){this.show_history(),this.$input.show(),this.$input.focus()}hide_input(){this.$input.hide(),this.playground.game_map.$canvas.focus()}}class GameMap extends AcGameObject{constructor(t){super(),this.playground=t,this.$canvas=$("<canvas tabindex=0></canvas>"),this.ctx=this.$canvas[0].getContext("2d"),this.ctx.canvas.width=this.playground.width,this.ctx.canvas.height=this.playground.height,this.playground.$playground.append(this.$canvas)}start(){this.$canvas.focus()}resize(){this.ctx.canvas.width=this.playground.width,this.ctx.canvas.height=this.playground.height,this.ctx.fillStyle="rgba(0, 0, 0, 1)",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}update(){this.render()}render(){this.ctx.fillStyle="rgba(0, 0, 0, 0.2)",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}}class NoticeBoard extends AcGameObject{constructor(t){super(),this.playground=t,this.ctx=this.playground.game_map.ctx,this.text="已就绪： 0人"}start(){}write(t){this.text=t}update(){this.render()}render(){this.ctx.font="20px serif",this.ctx.fillStyle="white",this.ctx.textAlign="center",this.ctx.fillText(this.text,this.playground.width/2,20)}}class Particle extends AcGameObject{constructor(t,s,i,e,a,h,n,r,o){super(),this.playground=t,this.ctx=this.playground.game_map.ctx,this.x=s,this.y=i,this.radius=e,this.vx=a,this.vy=h,this.color=n,this.speed=r,this.move_length=o,this.eps=.01,this.friction=.9}start(){}update(){if(this.move_length<this.eps||this.speed<this.eps)return this.destroy(),!1;const t=Math.min(this.move_length,this.speed*this.timedelta/1e3);this.x+=this.vx*t,this.y+=this.vy*t,this.speed*=this.friction,this.move_length-=t,this.render()}render(){const t=this.playground.scale;this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI),this.ctx.fillStyle=this.color,this.ctx.fill()}}class Player extends AcGameObject{constructor(t,s,i,e,a,h,n,r,o){super(),this.playground=t,this.x=s,this.y=i,this.vx=1,this.vy=1,this.damage_vx=0,this.damage_vy=0,this.damage_speed=0,this.move_length=0,this.radius=e,this.color=a,this.speed=h,this.character=n,this.username=r,this.photo=o,this.spent_time=0,this.ctx=this.playground.game_map.ctx,this.eps=.01,this.friction=.9,this.fireballs=[],this.cur_skill=null,"robot"!==this.character&&(this.img=new Image,this.img.src=this.photo),"me"===this.character&&(this.fireball_coldtime=3,this.fireball_img=new Image,this.fireball_img.src="https://cdn.acwing.com/media/article/image/2021/12/02/1_9340c86053-fireball.png",this.blink_coldtime=5,this.blink_img=new Image,this.blink_img.src="https://cdn.acwing.com/media/article/image/2021/12/02/1_daccabdc53-blink.png")}start(){if(this.playground.player_count++,this.playground.notice_board.write(`已就绪：${this.playground.player_count}人`),this.playground.player_count>=3&&(this.playground.state="fighting",this.playground.notice_board.write("Fighting")),"me"===this.character)this.add_listening_events();else if("robot"===this.character){const t=Math.random()*this.playground.width/this.playground.scale,s=Math.random()*this.playground.height/this.playground.scale;this.move_to(t,s)}}add_listening_events(){let t=this;this.playground.game_map.$canvas.on("contextmenu",(function(){return!1})),this.playground.game_map.$canvas.mousedown((function(s){if("fighting"!==t.playground.state)return!1;const i=t.ctx.canvas.getBoundingClientRect();if(3===s.which){const e=(s.clientX-i.left)/t.playground.scale,a=(s.clientY-i.top)/t.playground.scale;t.move_to(e,a),"multi mode"===t.playground.mode&&t.playground.mps.send_move_to(e,a)}else if(1===s.which){const e=(s.clientX-i.left)/t.playground.scale,a=(s.clientY-i.top)/t.playground.scale;if("fireball"===t.cur_skill){const s=t.shoot_fireball(e,a);"multi mode"===t.playground.mode&&t.playground.mps.send_shoot_fireball(e,a,s.uuid)}else"blink"===t.cur_skill&&(t.blink(e,a),"multi mode"===t.playground.mode&&t.playground.mps.send_blink(e,a));t.cur_skill=null}})),this.playground.game_map.$canvas.keydown((function(s){if(13===s.which){if("multi mode"===t.playground.mode)return t.playground.chat_field.show_input(),!1}else if(27===s.which&&"multi mode"===t.playground.mode)return t.playground.chat_field.hide_input(),!1;return"fighting"!==t.playground.state||(81===s.which?t.fireball_coldtime>t.eps||(t.cur_skill="fireball",!1):70===s.which?t.blink_coldtime>t.eps||(t.cur_skill="blink",!1):void 0)}))}shoot_fireball(t,s){const i=this.x,e=this.y,a=Math.atan2(s-e,t-i),h=Math.cos(a),n=Math.sin(a),r=new FireBall(this.playground,this,i,e,.01,h,n,"orange",.5,1,.01);return this.fireballs.push(r),this.fireball_coldtime=3,r}destroy_fireball(t){for(let s=0;s<this.fireballs.length;s++){const i=this.fireballs[s];if(i.uuid===t){i.destroy();break}}}blink(t,s){const i=Math.min(this.get_dist(this.x,this.y,t,s),.8),e=Math.atan2(s-this.y,t-this.x);this.x+=i*Math.cos(e),this.y+=i*Math.sin(e),this.blink_coldtime=5,this.move_length=0}get_dist(t,s,i,e){const a=t-i,h=s-e;return Math.sqrt(a*a+h*h)}move_to(t,s){this.move_length=this.get_dist(this.x,this.y,t,s);const i=Math.atan2(s-this.y,t-this.x);this.vx=Math.cos(i),this.vy=Math.sin(i)}is_attacked(t,s){for(let t=0;t<20+10*Math.random();t++){const t=this.x,s=this.y,i=this.radius*Math.random()*.1,e=2*Math.PI*Math.random(),a=Math.cos(e),h=Math.sin(e),n=this.color,r=10*this.speed,o=this.radius*Math.random()*5;new Particle(this.playground,t,s,i,a,h,n,r,o)}if(this.radius-=s,this.radius<this.eps)return this.destroy(),!1;this.damage_vx=Math.cos(t),this.damage_vy=Math.sin(t),this.damage_speed=100*s,this.speed*=.8}receive_attack(t,s,i,e,a,h){h.destroy_fireball(a),this.x=t,this.y=s,this.is_attacked(i,e)}update(){this.spent_time+=this.timedelta/1e3,this.update_win(),"me"===this.character&&"fighting"===this.playground.state&&this.update_coldtime(),this.update_move(),this.render()}update_win(){"fighting"===this.playground.state&&"me"===this.character&&1===this.playground.players.length&&(this.playground.state="over",this.playground.score_board.win())}update_coldtime(){this.fireball_coldtime-=this.timedelta/1e3,this.fireball_coldtime=Math.max(this.fireball_coldtime,0),this.blink_coldtime-=this.timedelta/1e3,this.blink_coldtime=Math.max(this.blink_coldtime,0)}update_move(){if(this.spent_time>5&&"robot"===this.character&&Math.random()<1/300){const t=this.playground.players[Math.floor(Math.random()*this.playground.players.length)];t!==this&&this.shoot_fireball(t.x,t.y)}if(this.damage_speed>this.eps){this.vx=this.vy=0,this.move_length=0;const t=this.damage_speed*this.timedelta/1e3;this.x+=this.damage_vx*t,this.y+=this.damage_vy*t,this.damage_speed*=this.friction}else if(this.move_length<this.eps){if(this.move_length=0,this.vx=this.vy=0,"robot"===this.character){const t=Math.random()*this.playground.width/this.playground.scale,s=Math.random();this.move_to(t,s)}}else{const t=Math.min(this.move_length,this.speed*this.timedelta/1e3);this.x+=this.vx*t,this.y+=this.vy*t,this.move_length-=t}}render(){const t=this.playground.scale;"robot"!==this.character?(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI),this.ctx.stroke(),this.ctx.clip(),this.ctx.drawImage(this.img,(this.x-this.radius)*t,(this.y-this.radius)*t,2*this.radius*t,2*this.radius*t),this.ctx.restore()):(this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI),this.ctx.fillStyle=this.color,this.ctx.fill()),"me"===this.character&&"fighting"===this.playground.state&&this.render_skill_coldtime()}render_skill_coldtime(){let t=1.5,s=.9,i=.04;const e=this.playground.scale;this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t*e,s*e,i*e,0,2*Math.PI),this.ctx.stroke(),this.ctx.clip(),this.ctx.drawImage(this.fireball_img,(t-i)*e,(s-i)*e,2*i*e,2*i*e),this.ctx.restore(),this.fireball_coldtime>0&&(this.ctx.beginPath(),this.ctx.moveTo(t*e,s*e),this.ctx.arc(t*e,s*e,i*e,0-Math.PI/2,2*Math.PI*(1-this.fireball_coldtime/3)-Math.PI/2,!0),this.ctx.lineTo(t*e,s*e),this.ctx.fillStyle="rgba(0, 0, 255, 0.6)",this.ctx.fill()),t=1.62,this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t*e,s*e,i*e,0,2*Math.PI),this.ctx.stroke(),this.ctx.clip(),this.ctx.drawImage(this.blink_img,(t-i)*e,(s-i)*e,2*i*e,2*i*e),this.ctx.restore(),this.blink_coldtime>0&&(this.ctx.beginPath(),this.ctx.moveTo(t*e,s*e),this.ctx.arc(t*e,s*e,i*e,0-Math.PI/2,2*Math.PI*(1-this.blink_coldtime/5)-Math.PI/2,!0),this.ctx.lineTo(t*e,s*e),this.ctx.fillStyle="rgba(0, 0, 255, 0.6)",this.ctx.fill())}on_destroy(){"me"===this.character&&"fighting"===this.playground.state&&(this.playground.state="over",this.playground.score_board.lose());for(const t in this.playground.players)if(this.playground.players[t]===this){this.playground.players.splice(t,1);break}}}class ScoreBoard extends AcGameObject{constructor(t){super(),this.playground=t,this.ctx=this.playground.game_map.ctx,this.state=null,this.win_img=new Image,this.lose_img=new Image,this.win_img.src="https://cdn.acwing.com/media/article/image/2021/12/17/1_8f58341a5e-win.png",this.lose_img.src="https://cdn.acwing.com/media/article/image/2021/12/17/1_9254b5f95e-lose.png"}start(){}add_listening_events(){this.playground.game_map.$canvas.on("click",(()=>{this.playground.hide(),this.playground.root.menu.show()}))}win(){this.state="win",setTimeout((()=>{this.add_listening_events()}),1e3)}lose(){this.state="lose",setTimeout((()=>{this.add_listening_events()}),1e3)}late_update(){this.render()}render(){const t=this.playground.height/2;"win"===this.state?this.ctx.drawImage(this.win_img,this.playground.width/2-t/2,this.playground.height/2-t/2,t,t):"lose"===this.state&&this.ctx.drawImage(this.lose_img,this.playground.width/2-t/2,this.playground.height/2-t/2,t,t)}}class FireBall extends AcGameObject{constructor(t,s,i,e,a,h,n,r,o,l,d){super(),this.playground=t,this.player=s,this.x=i,this.y=e,this.radius=a,this.vx=h,this.vy=n,this.color=r,this.speed=o,this.move_length=l,this.damage=d,this.ctx=this.playground.game_map.ctx,this.eps=.01}start(){}update(){if(this.move_length<this.eps)return this.destroy(),!1;this.update_move(),"enemy"!==this.player.character&&this.update_attack(),this.render()}update_move(){const t=Math.min(this.move_length,this.speed*this.timedelta/1e3);this.x+=this.vx*t,this.y+=this.vy*t,this.move_length-=t}update_attack(){for(const t of this.playground.players)if(this.player!==t&&this.is_collision(t)){this.attack(t);break}}get_dist(t,s,i,e){const a=t-i,h=s-e;return Math.sqrt(a*a+h*h)}is_collision(t){return this.get_dist(this.x,this.y,t.x,t.y)<this.radius+t.radius}attack(t){const s=Math.atan2(t.y-this.y,t.x-this.x);t.is_attacked(s,this.damage),"multi mode"===this.playground.mode&&this.playground.mps.send_attack(t.uuid,t.x,t.y,s,this.damage,this.uuid),this.destroy()}render(){const t=this.playground.scale;this.ctx.beginPath(),this.ctx.arc(this.x*t,this.y*t,this.radius*t,0,2*Math.PI),this.ctx.fillStyle=this.color,this.ctx.fill()}on_destroy(){const t=this.player.fireballs;for(let s=0;s<t.length;s++)if(t[s]===this){t.splice(s,1);break}}}class MultiPlayerSocket{constructor(t){this.playground=t,this.ws=new WebSocket("wss://app5415.acapp.acwing.com.cn/wss/multiplayer/"),this.start()}start(){this.receive()}receive(){this.ws.onmessage=t=>{const s=JSON.parse(t.data),i=s.uuid;if(i===this.uuid)return!1;const e=s.event;"create_player"===e?this.receive_create_player(i,s.username,s.photo):"move_to"===e?this.receive_move_to(i,s.tx,s.ty):"shoot_fireball"===e?this.receive_shoot_fireball(i,s.tx,s.ty,s.ball_uuid):"attack"===e?this.receive_attack(i,s.attackee_uuid,s.x,s.y,s.angle,s.damage,s.ball_uuid):"blink"===e?this.receive_blink(i,s.tx,s.ty):"message"==e&&this.receive_message(i,s.username,s.text)}}send_create_player(t,s){this.ws.send(JSON.stringify({uuid:this.uuid,event:"create_player",username:t,photo:s}))}receive_create_player(t,s,i){let e=new Player(this.playground,this.playground.width/2/this.playground.scale,.5,.05,"white",.15,"enemy",s,i);e.uuid=t,this.playground.players.push(e)}send_move_to(t,s){this.ws.send(JSON.stringify({event:"move_to",uuid:this.uuid,tx:t,ty:s}))}get_player(t){for(const s of this.playground.players)if(s.uuid===t)return s;return null}receive_move_to(t,s,i){const e=this.get_player(t);e&&e.move_to(s,i)}send_shoot_fireball(t,s,i){this.ws.send(JSON.stringify({event:"shoot_fireball",uuid:this.uuid,tx:t,ty:s,ball_uuid:i}))}receive_shoot_fireball(t,s,i,e){const a=this.get_player(t);if(a){a.shoot_fireball(s,i).uuid=e}}send_attack(t,s,i,e,a,h){this.ws.send(JSON.stringify({event:"attack",uuid:this.uuid,attackee_uuid:t,x:s,y:i,angle:e,damage:a,ball_uuid:h}))}receive_attack(t,s,i,e,a,h,n){const r=this.get_player(t),o=this.get_player(s);r&&o&&o.receive_attack(i,e,a,h,n,r)}send_blink(t,s){this.ws.send(JSON.stringify({event:"blink",uuid:this.uuid,tx:t,ty:s}))}receive_blink(t,s,i){const e=this.get_player(t);e&&e.blink(s,i)}send_message(t,s){this.ws.send(JSON.stringify({event:"message",uuid:this.uuid,username:t,text:s}))}receive_message(t,s,i){this.playground.chat_field.add_message(s,i)}}class AcGamePlayground{constructor(t){this.root=t,this.$playground=$('<div class="ac-game-playground"></div>'),this.hide(),this.root.$ac_game.append(this.$playground),this.start()}get_random_color(){const t=["blue","red","pink","grey","green"];return t[Math.floor(Math.random()*t.length)]}create_uuid(){let t="";for(let s=0;s<8;s++){t+=parseInt(Math.floor(10*Math.random()))}return t}start(){const t=this.create_uuid();$(window).on(`resize.${t}`,(()=>{this.resize()})),this.root.AcWingOS&&this.root.AcWingOS.api.window.on_close((()=>{$(window).off(`resize.${t}`)}))}resize(){const t=this.$playground.width(),s=this.$playground.height(),i=Math.min(t/16,s/9);this.width=16*i,this.height=9*i,this.scale=this.height,this.game_map&&this.game_map.resize()}show(t){if(this.$playground.show(),this.resize(),this.mode=t,this.state="waiting",this.game_map=new GameMap(this),this.notice_board=new NoticeBoard(this),this.score_board=new ScoreBoard(this),this.player_count=0,this.players=[],this.players.push(new Player(this,this.width/2/this.scale,.5,.05,"white",.15,"me",this.root.settings.username,this.root.settings.photo)),"single mode"===t)for(let t=0;t<5;t++){const t=this.get_random_color();this.players.push(new Player(this,this.width/2/this.height,.5,.05,t,.15,"robot"))}else"multi mode"===t&&(this.chat_field=new ChatField(this),this.mps=new MultiPlayerSocket(this),this.mps.uuid=this.players[0].uuid,this.mps.ws.onopen=()=>{this.mps.send_create_player(this.root.settings.username,this.root.settings.photo)})}hide(){for(;this.players&&this.players.length>0;)this.players[0].destroy();this.game_map&&(this.game_map.destroy(),this.game_map=null),this.notice_board&&(this.notice_board.destroy(),this.notice_board=null),this.score_board&&(this.score_board.destroy(),this.score_board=null),this.$playground.empty(),this.$playground.hide()}}class Settings{constructor(t){this.root=t,this.platform="WEB",this.root.AcWingOS&&(this.platform="ACAPP"),this.username="",this.photo="",this.$settings=$('\n<div class="ac-game-settings">\n    <div class="ac-game-settings-login">\n        <div class="ac-game-settings-title">登录</div>\n        <div class="ac-game-settings-username">\n            <div class="ac-game-settings-item">\n                <input type="text" placeholder="用户名">\n            </div>\n        </div>\n        <div class="ac-game-settings-password">\n           <div class="ac-game-settings-item">\n                <input type="password" placeholder="密码">\n            </div>\n        </div>\n        <div class="ac-game-settings-submit">\n            <div class="ac-game-settings-item">\n                <button>登录</button>\n            </div>\n        </div>\n        <div class="ac-game-settings-error-message">\n        </div>\n        <div class="ac-game-settings-option">\n            注册\n        </div>\n        <br>\n        \x3c!--\n        <div class="ac-game-settings-acwing">\n            <img width="30" src="https://wiki.connect.qq.com/wp-content/uploads/2013/10/03_qq_symbol-1-250x300.png">\n            <div>QQ账户登录</div>\n        </div>\n        --\x3e\n    </div>\n    <div class="ac-game-settings-register">\n        <div class="ac-game-settings-title">注册</div>\n        <div class="ac-game-settings-username">\n            <div class="ac-game-settings-item">\n                <input type="text" placeholder="用户名">\n            </div>\n        </div>\n        <div class="ac-game-settings-password ac-game-settings-password-first">\n           <div class="ac-game-settings-item">\n                <input type="password" placeholder="密码">\n            </div>\n        </div>\n        <div class="ac-game-settings-password ac-game-settings-password-second">\n           <div class="ac-game-settings-item">\n                <input type="password" placeholder="确认密码">\n            </div>\n        </div>\n        <div class="ac-game-settings-submit">\n            <div class="ac-game-settings-item">\n                <button>注册</button>\n            </div>\n        </div>\n        <div class="ac-game-settings-error-message">\n        </div>\n        <div class="ac-game-settings-option">\n            登录\n        </div>\n    </div>\n</div>\n'),this.$login=this.$settings.find(".ac-game-settings-login"),this.$login_username=this.$login.find(".ac-game-settings-username input"),this.$login_password=this.$login.find(".ac-game-settings-password input"),this.$login_submit=this.$login.find(".ac-game-settings-submit button"),this.$login_error_message=this.$login.find(".ac-game-settings-error-message"),this.$login_register=this.$login.find(".ac-game-settings-option"),this.$login.hide(),this.$register=this.$settings.find(".ac-game-settings-register"),this.$register_username=this.$register.find(".ac-game-settings-username input"),this.$register_password=this.$register.find(".ac-game-settings-password-first input"),this.$register_password_confirm=this.$register.find(".ac-game-settings-password-second input"),this.$register_submit=this.$register.find(".ac-game-settings-submit button"),this.$register_error_message=this.$register.find(".ac-game-settings-error-message"),this.$register_login=this.$register.find(".ac-game-settings-option"),this.$register.hide(),this.root.$ac_game.append(this.$settings),this.start()}start(){this.getinfo(),this.add_listening_events()}add_listening_events(){this.add_listening_events_login(),this.add_listening_events_register()}add_listening_events_login(){let t=this;this.$login_register.click((function(){t.register()})),this.$login_submit.click((function(){t.login_on_remote()}))}add_listening_events_register(){let t=this;this.$register_login.click((function(){t.login()})),this.$register_submit.click((function(){t.register_on_remote()}))}login_on_remote(){let t=this;const s=this.$login_username.val(),i=this.$login_password.val();this.$login_error_message.empty(),$.ajax({url:"https://app5415.acapp.acwing.com.cn/settings/login/",type:"GET",data:{username:s,password:i},success(s){"success"===s.result?location.reload():t.$login_error_message.html(s.error_message)}})}logout_on_remote(){"ACAPP"===this.platform?(console.log("dshkjfhjk"),this.root.AcWingOS.api.window.close()):$.ajax({url:"https://app5415.acapp.acwing.com.cn/settings/logout/",type:"GET",success(t){"success"===t.result&&location.reload()}})}register_on_remote(){const t=this,s=this.$register_username.val(),i=this.$register_password.val(),e=this.$register_password_confirm.val();this.$register_error_message.empty(),$.ajax({url:"https://app5415.acapp.acwing.com.cn/settings/register/",type:"GET",data:{username:s,password:i,password_confirm:e},success(s){"success"===s.result?location.reload():t.$register_error_message.html(s.error_message)}})}register(){this.$login.hide(),this.$register.show()}login(){this.$register.hide(),this.$login.show()}getinfo(){let t=this;$.ajax({url:"https://app5415.acapp.acwing.com.cn/settings/getinfo/",type:"GET",data:{platform:t.platform},success:function(s){"success"===s.result?(t.username=s.username,t.photo=s.photo,t.hide(),t.root.menu.show()):t.login()}})}hide(){this.$settings.hide()}show(){this.$settings.show()}}export class AcGame{constructor(t,s){this.id=t,this.$ac_game=$("#"+t),this.AcWingOS=s,this.settings=new Settings(this),this.menu=new AcGameMenu(this),this.playground=new AcGamePlayground(this),this.start()}start(){}}
